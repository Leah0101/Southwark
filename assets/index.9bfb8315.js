var e=Object.defineProperty,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,t=(o,l,a)=>l in o?e(o,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[l]=a;import{a as n,p as s,b as u,r as c,o as r,c as i,d,e as v,F as f,f as g,g as m,w as h,u as p,D as y,s as w,n as b,h as k,i as T,j as x}from"./vendor.764e7ee0.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver((e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&o(e)})).observe(document,{childList:!0,subtree:!0})}function o(e){if(e.ep)return;e.ep=!0;const o=function(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?o.credentials="include":"anonymous"===e.crossorigin?o.credentials="omit":o.credentials="same-origin",o}(e);fetch(e.href,o)}}();n.defaults.baseURL="https://southwark.corona.studio";const C=e=>n.get("/mark",{params:e});s("data-v-68da9f3e");const j={class:"map"},B=["onClick","onTouchstart","onTouchend"];u();const O={setup(e){const s=c([]),u=c(null),T=c(null),x=c(null);function O(e){let o=e.pageX,l=e.pageY;console.log(T.value.width,T.value.height),console.log("Absolute position",o,l),V.value=!0,u.value={x:o/T.value.width*100,y:l/T.value.height*100,message:""},setTimeout((()=>{x.value.focus(),console.log(x.value)}),10),console.log(o,l,T.value.width,T.value.height,s.value)}const V=c(!1),E=c(0),L=c("");function P(){var e;L.value&&(u.value.message=L.value,s.value.push(u.value),L.value="",(e=u.value,n.post("/mark",e)).then((e=>{console.log("创建成功",e),w({message:"Created successfully",wordBreak:"break-word"}),C().then((e=>{console.log(e),s.value=e.data})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)})))}const U=c(!1),I=c(""),R=c(null);function _(){console.log("editDialogClick",u.value),u.value.message=I.value;const e=u.value.id;var c;(c=((e,n)=>{for(var s in n||(n={}))l.call(n,s)&&t(e,s,n[s]);if(o)for(var s of o(n))a.call(n,s)&&t(e,s,n[s]);return e})({id:e},u.value),n.post(`/mark/${c.id}`,c)).then((e=>{console.log(e),w({message:"Edit successfully",wordBreak:"break-word"}),C().then((e=>{console.log(e),s.value=e.data})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))}let D;function N(e){return D=setTimeout((function(){!function(e){D=0,console.log("长按"),(o={id:e},n.delete(`/mark/${o.id}`)).then((e=>{console.log("删除",e),w({message:"Deleted successfully",wordBreak:"break-word"}),C().then((e=>{console.log(e),s.value=e.data})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}));var o}(e)}),500),!1}return C().then((e=>{console.log(e),s.value=e.data})).catch((e=>{console.log(e)})),r((()=>{console.log("onMounted")})),(e,o)=>(i(),d("div",j,[v("img",{class:"bg-img",src:"./assets/bao.c1c97624.jpg",alt:"",onClick:O,ref:(e,o)=>{o.imgRef=e,T.value=e}},null,512),(i(!0),d(f,null,g(s.value,((e,l)=>(i(),d("div",{class:"mark",style:b({left:e.x+"%",top:e.y+"%"}),onClick:e=>function(e){U.value=!0,setTimeout((()=>{console.log(R.value),R.value.focus()}),10),E.value=e,u.value=s.value[e],I.value=s.value[e].message,console.log("markClick",e,L.value,E.value,s.value)}(l),onTouchstart:o=>N(e.id),onTouchmove:o[0]||(o[0]=e=>(clearTimeout(D),void(D=0))),onTouchend:o=>(e.id,clearTimeout(D),0!=D&&console.log("点击但未长按"),!1)},null,44,B)))),256)),m(p(y),{show:V.value,"onUpdate:show":o[2]||(o[2]=e=>V.value=e),title:"Input information","show-cancel-button":"",confirmButtonText:"create",cancelButtonText:"cancel",onConfirm:o[3]||(o[3]=e=>P())},{default:h((()=>[m(p(k),{modelValue:L.value,"onUpdate:modelValue":o[1]||(o[1]=e=>L.value=e),autosize:"",type:"textarea",maxlength:"150",placeholder:"Please enter a message",autofocus:!0,ref:(e,o)=>{o.fieldRef=e,x.value=e}},null,8,["modelValue"])])),_:1},8,["show"]),m(p(y),{show:U.value,"onUpdate:show":o[5]||(o[5]=e=>U.value=e),title:"Edit information","show-cancel-button":"",onConfirm:o[6]||(o[6]=e=>_()),confirmButtonText:"edit",cancelButtonText:"cancel"},{default:h((()=>[m(p(k),{modelValue:I.value,"onUpdate:modelValue":o[4]||(o[4]=e=>I.value=e),autosize:"",type:"textarea",maxlength:"150",placeholder:"Edit your message",ref:(e,o)=>{o.editFieldRef=e,R.value=e}},null,8,["modelValue"])])),_:1},8,["show"])]))},__scopeId:"data-v-68da9f3e"};x({setup:e=>(e,o)=>(i(),T(O))}).mount("#app");
